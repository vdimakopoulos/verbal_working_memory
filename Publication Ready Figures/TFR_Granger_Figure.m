% %% Close all figures, clear variables and command window
% close all
% clear
% clc

%% Paths
strPaths.Main = 'F:\Vasileios\';
strPaths.Project = [strPaths.Main, 'Task Analysis\'];
strPaths.GeneralFunctions = 'F:\Vasileios\Task Analysis\Code\';
strPaths.Data = [strPaths.Main, 'Task Analysis\Data\'];
strPaths.ExtractedData = [strPaths.Main, 'Task Analysis\Extracted_Data Sternberg\'];
strPaths.Statistics = [strPaths.Main, 'Task Analysis\Code\Statistics\'];
strPaths.ChanLoc = [strPaths.Main, 'Task Analysis\Code\Channel Localization\'];
strPaths.EEGLAB_Subfunctions = [strPaths.Main,'Task Analysis\Code\Subfunctions\EEGLAB Subfunctions\'];
strPaths.Subfunctions = [strPaths.Main,'Task Analysis\Code\Subfunctions\']
% Results
strPaths.Results = [strPaths.Main,'Task Analysis\Analysis Results\'];

% FieldTrip toolbox
% strPaths.Toolboxes.FieldTrip            = 'F:\Vasileios\Toolboxes\fieldtrip-20191126\';
strPaths.Toolboxes.FieldTrip            = 'F:\Vasileios\Toolboxes\fieldtrip-20200315\';

% EEGLAB toolbox
strPaths.Toolboxes.EEGLAB               = 'F:\Vasileios\Toolboxes\eeglab14_1_1b\';

% Change main directory
cd(strPaths.Main)

% Add all subfolders to path
addpath(strPaths.Main)
addpath(genpath(strPaths.Project))
addpath(genpath(strPaths.GeneralFunctions))
addpath(strPaths.Data)
addpath(strPaths.ExtractedData)
addpath(strPaths.Statistics)
addpath(strPaths.ChanLoc)
addpath(strPaths.Subfunctions)
addpath(strPaths.EEGLAB_Subfunctions)
addpath(strPaths.Results)
addpath(strPaths.Toolboxes.FieldTrip)
% Remove EEGLAB from path

% rmpath(genpath(strPaths.Toolboxes.EEGLAB))


% Plot colors
strPlotColors = {'b','g','r','c','k','m'};
ft_defaults
%Add figure tools on toolbar
set(groot,'defaultFigureCreateFcn',@(fig,~)addToolbarExplorationButtons(fig))
set(groot,'defaultAxesCreateFcn',@(ax,~)set(ax.Toolbar,'Visible','off'))

%% Figure Axes
fig = figure;
set(fig,'Units', 'centimeters')
set(fig,'Position',[4.8948,2.8581,15,20]);
h = gcf;
set(h,'color','white')
ha = tight_subplot(3,2,[.08 .05],[.1 .04],[.06 .03])

%% Figure Data
strPaths.FigureData = [strPaths.Data,'Analysis Data\Figure Data\'];
strFilename = [strPaths.FigureData,'TFR Granger Data for Figure\TFR_Granger_var'];
load(strFilename);

P37 = TimeFrequencyGranger_var.GrangerSpectra.P37;
P38 = TimeFrequencyGranger_var.GrangerSpectra.P38;
P40 = TimeFrequencyGranger_var.GrangerSpectra.P40;
P42 = TimeFrequencyGranger_var.GrangerSpectra.P42;
P44 = TimeFrequencyGranger_var.GrangerSpectra.P44;

timeAxis = TimeFrequencyGranger_var.GrangerSpectra.time;
freqAxis = TimeFrequencyGranger_var.GrangerSpectra.freq;
clim = TimeFrequencyGranger_var.GrangerSpectra.clim;

%% Panel a

axes(ha(1));
contourf(timeAxis,freqAxis,P42,100,'LineColor','none')
Xlab(1) = xlabel('Time (s)');
Ylab(1) = ylabel('Frequency (Hz)');
ylim([5 30]);
title('Subject 1')
cbh = colorbar

set(ha(1),'clim',clim,'yscale','log','Colormap',...
           [0 0 0.5;0 0.0153846153846154 0.515384615384615;0 0.0307692307692308 0.530769230769231;0 0.0461538461538462 0.546153846153846;0 0.0615384615384615 0.561538461538462;0 0.0769230769230769 0.576923076923077;0 0.0923076923076923 0.592307692307692;0 0.107692307692308 0.607692307692308;0 0.123076923076923 0.623076923076923;0 0.138461538461538 0.638461538461538;0 0.153846153846154 0.653846153846154;0 0.169230769230769 0.669230769230769;0 0.184615384615385 0.684615384615385;0 0.2 0.7;0 0.215384615384615 0.715384615384615;0 0.230769230769231 0.730769230769231;0 0.246153846153846 0.746153846153846;0 0.261538461538461 0.761538461538461;0 0.276923076923077 0.776923076923077;0 0.292307692307692 0.792307692307692;0 0.307692307692308 0.807692307692308;0 0.323076923076923 0.823076923076923;0 0.338461538461538 0.838461538461538;0 0.353846153846154 0.853846153846154;0 0.369230769230769 0.869230769230769;0 0.384615384615385 0.884615384615384;0 0.4 0.9;0 0.415384615384615 0.915384615384615;0 0.430769230769231 0.930769230769231;0 0.446153846153846 0.946153846153846;0 0.461538461538462 0.961538461538462;0 0.476923076923077 0.976923076923077;0 0.492307692307692 0.992307692307692;0.0153846153846156 0.507692307692308 1;0.0461538461538464 0.523076923076923 1;0.0769230769230774 0.538461538461539 1;0.107692307692308 0.553846153846154 1;0.138461538461539 0.56923076923077 1;0.16923076923077 0.584615384615385 1;0.200000000000001 0.6 1;0.230769230769232 0.615384615384616 1;0.261538461538462 0.630769230769231 1;0.292307692307693 0.646153846153847 1;0.323076923076924 0.661538461538462 1;0.353846153846155 0.676923076923078 1;0.384615384615386 0.692307692307693 1;0.415384615384617 0.707692307692308 1;0.446153846153848 0.723076923076924 1;0.476923076923078 0.738461538461539 1;0.507692307692309 0.753846153846155 1;0.53846153846154 0.76923076923077 1;0.569230769230771 0.784615384615385 1;0.600000000000002 0.800000000000001 1;0.630769230769233 0.815384615384616 1;0.661538461538464 0.830769230769232 1;0.692307692307694 0.846153846153847 1;0.723076923076925 0.861538461538463 1;0.753846153846156 0.876923076923078 1;0.784615384615387 0.892307692307693 1;0.815384615384618 0.907692307692309 1;0.846153846153848 0.923076923076924 1;0.876923076923079 0.93846153846154 1;0.90769230769231 0.953846153846155 1;0.938461538461541 0.969230769230771 1;0.972972972972973 0.986486486486487 1;0.996138996138996 0.998069498069498 1;1 1 1;1 0.978021978021978 0.978021978021978;1 0.945054945054944 0.945054945054944;1 0.912087912087911 0.912087912087911;1 0.879120879120878 0.879120879120878;1 0.846153846153845 0.846153846153845;1 0.813186813186812 0.813186813186812;1 0.780219780219779 0.780219780219779;1 0.747252747252746 0.747252747252746;1 0.714285714285713 0.714285714285713;1 0.681318681318679 0.681318681318679;1 0.648351648351646 0.648351648351646;1 0.615384615384613 0.615384615384613;1 0.58241758241758 0.58241758241758;1 0.549450549450547 0.549450549450547;1 0.516483516483514 0.516483516483514;1 0.483516483516481 0.483516483516481;1 0.450549450549448 0.450549450549448;1 0.417582417582414 0.417582417582414;1 0.384615384615381 0.384615384615381;1 0.351648351648348 0.351648351648348;1 0.318681318681315 0.318681318681315;1 0.285714285714282 0.285714285714282;1 0.252747252747249 0.252747252747249;1 0.219780219780216 0.219780219780216;1 0.186813186813183 0.186813186813183;1 0.153846153846149 0.153846153846149;1 0.120879120879116 0.120879120879116;1 0.0879120879120832 0.0879120879120832;1 0.0549450549450501 0.0549450549450501;1 0.021978021978017 0.021978021978017;0.994505494505492 0 0;0.978021978021975 0 0;0.961538461538459 0 0;0.945054945054942 0 0;0.928571428571426 0 0;0.912087912087909 0 0;0.895604395604393 0 0;0.879120879120876 0 0;0.862637362637359 0 0;0.846153846153843 0 0;0.829670329670326 0 0;0.81318681318681 0 0;0.796703296703293 0 0;0.780219780219777 0 0;0.76373626373626 0 0;0.747252747252743 0 0;0.730769230769227 0 0;0.71428571428571 0 0;0.697802197802194 0 0;0.681318681318677 0 0;0.664835164835161 0 0;0.648351648351644 0 0;0.631868131868128 0 0;0.615384615384611 0 0;0.598901098901094 0 0;0.582417582417578 0 0;0.565934065934061 0 0;0.549450549450545 0 0;0.532967032967028 0 0;0.516483516483512 0 0;0.5 0 0]);
set(ha(1),'ytick',[5 10 20 30] ,'YTickLabel',[5,10,20,30]);
set(ha(1),'FontSize',10);
set(ha(1),'XTick',[-5 -3 0], 'XTickLabel',[-5 -3 0]);
set(ha(1),'box','off');
set(ha(1),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(Ylab(1),'Position',[-6.858752197760312,10.956865192519452,1]);
set(Xlab(1),'Position',[-1.529407950008617,4.192223962061501,1]);
set(cbh,'Ticks',[-0.2:0.2:0.2],'TickLabels',[-0.2:0.2:0.2]);
line([-5 -5],get(ha(1),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([-3 -3],get(ha(1),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([0 0],get(ha(1),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)

annotation('textbox',...
    [0.0084033613445378 0.965565350540506 0.0259978985413909 0.0435663617188686],...
    'String',{'a'},...
    'FontWeight','bold',...
    'FontSize',11,...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.335131234950123 0.688635765614538 0.201083327866263 0.0357187493297582],...
    'Color',[0.149019607843137 0.149019607843137 0.149019607843137],...
    'String','Cortex -> Hipp',...
    'FontWeight','bold',...
    'EdgeColor','none');

%Create textbox
annotation('textbox',...
    [0.335131234950123 0.95983368228119 0.201083327866263 0.0357187493297582],...
    'Color',[0.149019607843137 0.149019607843137 0.149019607843137],...
    'String','Hipp -> Cortex',...
    'FontWeight','bold',...
    'EdgeColor','none');


annotation('textbox',...
    [0.0582006793945675 0.719062848790154 0.0582083321242697 0.0304270828207954],...
    'Color',[0.15 0.15 0.15],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.0917145682834565 0.719062848790154 0.107597219541255 0.0304270828207954],...
    'Color',[0.15 0.15 0.15],...
    'String','encoding',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.179909012727901 0.719062848790154 0.134055552086069 0.0304270828207955],...
    'Color',[0.15 0.15 0.15],...
    'String','maintenance',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');




 

%% Panel b


axes(ha(2));
contourf(timeAxis,freqAxis,P37,100,'LineColor','none')
Xlab(2) = xlabel('Time (s)');
Ylab(2) = ylabel('Frequency (Hz)');
ylim([5 30]);
% colormap(bluewhitered(128));
title('Subject 2')
cbh = colorbar


set(ha(2),'clim',clim,'yscale','log','Colormap',...
        [0 0 0.5;0 0.0153846153989434 0.515384614467621;0 0.0307692307978868 0.530769228935242;0 0.0461538471281528 0.546153843402863;0 0.0615384615957737 0.561538457870483;0 0.0769230797886848 0.576923072338104;0 0.0923076942563057 0.592307686805725;0 0.107692308723927 0.607692301273346;0 0.123076923191547 0.623076915740967;0 0.138461545109749 0.638461530208588;0 0.15384615957737 0.653846144676208;0 0.169230774044991 0.669230759143829;0 0.184615388512611 0.68461537361145;0 0.200000002980232 0.699999988079071;0 0.215384617447853 0.715384602546692;0 0.230769231915474 0.730769217014313;0 0.246153846383095 0.746153831481934;0 0.261538475751877 0.761538445949554;0 0.276923090219498 0.776923060417175;0 0.292307704687119 0.792307674884796;0 0.307692319154739 0.807692289352417;0 0.32307693362236 0.823076903820038;0 0.338461548089981 0.838461518287659;0 0.353846162557602 0.85384613275528;0 0.369230777025223 0.8692307472229;0 0.384615391492844 0.884615361690521;0 0.400000005960464 0.899999976158142;0 0.415384620428085 0.915384590625763;0 0.430769234895706 0.930769205093384;0 0.446153849363327 0.946153819561005;0 0.461538463830948 0.961538434028625;0 0.476923078298569 0.976923048496246;0 0.49230769276619 0.992307662963867;0.0153846153989434 0.507692337036133 1;0.0813186839222908 0.540659368038177 1;0.147252753376961 0.573626399040222 1;0.21318681538105 0.606593430042267 1;0.279120892286301 0.639560461044312 1;0.34505495429039 0.672527492046356 1;0.410989016294479 0.705494523048401 1;0.476923078298569 0.738461554050446 1;0.54285717010498 0.77142858505249 1;0.60879123210907 0.804395616054535 1;0.674725294113159 0.83736264705658 1;0.740659356117249 0.870329678058624 1;0.806593418121338 0.903296709060669 1;0.872527480125427 0.936263740062714 1;0.938461542129517 0.969230771064758 1;0.972972989082336 0.986486494541168 1;0.975078999996185 0.98753947019577 1;0.977185010910034 0.988592505455017 1;0.979290962219238 0.989645481109619 1;0.981396973133087 0.990698516368866 1;0.983502984046936 0.991751492023468 1;0.985608994960785 0.992804527282715 1;0.987715005874634 0.993857502937317 1;0.989821016788483 0.994910538196564 1;0.991926968097687 0.995963513851166 1;0.994032979011536 0.997016549110413 1;0.996138989925385 0.998069524765015 1;0.996360182762146 0.998180150985718 1;0.996581375598907 0.998290717601776 1;0.996802628040314 0.998401343822479 1;0.997023820877075 0.998511910438538 1;0.997245013713837 0.998622536659241 1;0.997466206550598 0.998733103275299 1;0.99768739938736 0.998843729496002 1;0.997908592224121 0.998954296112061 1;0.998129844665527 0.999064922332764 1;0.998351037502289 0.999175548553467 1;0.99857223033905 0.999286115169525 1;0.998793423175812 0.999396741390228 1;0.999014616012573 0.999507308006287 1;0.999235868453979 0.99961793422699 1;0.999457061290741 0.999728500843048 1;0.999678254127502 0.999839127063751 1;1 1 1;1 0.996336996555328 0.996336996555328;1 0.992673993110657 0.992673993110657;1 0.989010989665985 0.989010989665985;1 0.985347986221313 0.985347986221313;1 0.981684982776642 0.981684982776642;1 0.97802197933197 0.97802197933197;1 0.90973311662674 0.90973311662674;1 0.841444253921509 0.841444253921509;1 0.773155391216278 0.773155391216278;1 0.704866588115692 0.704866588115692;1 0.636577725410461 0.636577725410461;1 0.568288862705231 0.568288862705231;1 0.5 0.5;1 0.431711137294769 0.431711137294769;1 0.363422304391861 0.363422304391861;1 0.29513344168663 0.29513344168663;1 0.2268445789814 0.2268445789814;1 0.15855573117733 0.15855573117733;1 0.0902668759226799 0.0902668759226799;1 0.0219780225306749 0.0219780225306749;0.99450546503067 0 0;0.97802197933197 0 0;0.961538434028625 0 0;0.945054888725281 0 0;0.928571403026581 0 0;0.912087917327881 0 0;0.895604372024536 0 0;0.879120826721191 0 0;0.862637341022491 0 0;0.846153855323792 0 0;0.829670310020447 0 0;0.813186764717102 0 0;0.796703279018402 0 0;0.780219793319702 0 0;0.763736248016357 0 0;0.747252702713013 0 0;0.730769217014313 0 0;0.714285731315613 0 0;0.697802186012268 0 0;0.681318640708923 0 0;0.664835155010223 0 0;0.648351669311523 0 0;0.631868124008179 0 0;0.615384578704834 0 0;0.598901093006134 0 0;0.582417607307434 0 0;0.565934062004089 0 0;0.549450516700745 0 0;0.532967031002045 0 0;0.516483545303345 0 0;0.5 0 0])

set(ha(2),'clim',clim,'yscale','log','Colormap',...
     [0 0 0.5;0 0.0153846153846154 0.515384615384615;0 0.0307692307692308 0.530769230769231;0 0.0461538461538462 0.546153846153846;0 0.0615384615384615 0.561538461538462;0 0.0769230769230769 0.576923076923077;0 0.0923076923076923 0.592307692307692;0 0.107692307692308 0.607692307692308;0 0.123076923076923 0.623076923076923;0 0.138461538461538 0.638461538461538;0 0.153846153846154 0.653846153846154;0 0.169230769230769 0.669230769230769;0 0.184615384615385 0.684615384615385;0 0.2 0.7;0 0.215384615384615 0.715384615384615;0 0.230769230769231 0.730769230769231;0 0.246153846153846 0.746153846153846;0 0.261538461538461 0.761538461538461;0 0.276923076923077 0.776923076923077;0 0.292307692307692 0.792307692307692;0 0.307692307692308 0.807692307692308;0 0.323076923076923 0.823076923076923;0 0.338461538461538 0.838461538461538;0 0.353846153846154 0.853846153846154;0 0.369230769230769 0.869230769230769;0 0.384615384615385 0.884615384615384;0 0.4 0.9;0 0.415384615384615 0.915384615384615;0 0.430769230769231 0.930769230769231;0 0.446153846153846 0.946153846153846;0 0.461538461538462 0.961538461538462;0 0.476923076923077 0.976923076923077;0 0.492307692307692 0.992307692307692;0.0153846153846156 0.507692307692308 1;0.0461538461538464 0.523076923076923 1;0.0769230769230774 0.538461538461539 1;0.107692307692308 0.553846153846154 1;0.138461538461539 0.56923076923077 1;0.16923076923077 0.584615384615385 1;0.200000000000001 0.6 1;0.230769230769232 0.615384615384616 1;0.261538461538462 0.630769230769231 1;0.292307692307693 0.646153846153847 1;0.323076923076924 0.661538461538462 1;0.353846153846155 0.676923076923078 1;0.384615384615386 0.692307692307693 1;0.415384615384617 0.707692307692308 1;0.446153846153848 0.723076923076924 1;0.476923076923078 0.738461538461539 1;0.507692307692309 0.753846153846155 1;0.53846153846154 0.76923076923077 1;0.569230769230771 0.784615384615385 1;0.600000000000002 0.800000000000001 1;0.630769230769233 0.815384615384616 1;0.661538461538464 0.830769230769232 1;0.692307692307694 0.846153846153847 1;0.723076923076925 0.861538461538463 1;0.753846153846156 0.876923076923078 1;0.784615384615387 0.892307692307693 1;0.815384615384618 0.907692307692309 1;0.846153846153848 0.923076923076924 1;0.876923076923079 0.93846153846154 1;0.90769230769231 0.953846153846155 1;0.938461538461541 0.969230769230771 1;0.972972972972973 0.986486486486487 1;0.996138996138996 0.998069498069498 1;1 1 1;1 0.978021978021978 0.978021978021978;1 0.945054945054944 0.945054945054944;1 0.912087912087911 0.912087912087911;1 0.879120879120878 0.879120879120878;1 0.846153846153845 0.846153846153845;1 0.813186813186812 0.813186813186812;1 0.780219780219779 0.780219780219779;1 0.747252747252746 0.747252747252746;1 0.714285714285713 0.714285714285713;1 0.681318681318679 0.681318681318679;1 0.648351648351646 0.648351648351646;1 0.615384615384613 0.615384615384613;1 0.58241758241758 0.58241758241758;1 0.549450549450547 0.549450549450547;1 0.516483516483514 0.516483516483514;1 0.483516483516481 0.483516483516481;1 0.450549450549448 0.450549450549448;1 0.417582417582414 0.417582417582414;1 0.384615384615381 0.384615384615381;1 0.351648351648348 0.351648351648348;1 0.318681318681315 0.318681318681315;1 0.285714285714282 0.285714285714282;1 0.252747252747249 0.252747252747249;1 0.219780219780216 0.219780219780216;1 0.186813186813183 0.186813186813183;1 0.153846153846149 0.153846153846149;1 0.120879120879116 0.120879120879116;1 0.0879120879120832 0.0879120879120832;1 0.0549450549450501 0.0549450549450501;1 0.021978021978017 0.021978021978017;0.994505494505492 0 0;0.978021978021975 0 0;0.961538461538459 0 0;0.945054945054942 0 0;0.928571428571426 0 0;0.912087912087909 0 0;0.895604395604393 0 0;0.879120879120876 0 0;0.862637362637359 0 0;0.846153846153843 0 0;0.829670329670326 0 0;0.81318681318681 0 0;0.796703296703293 0 0;0.780219780219777 0 0;0.76373626373626 0 0;0.747252747252743 0 0;0.730769230769227 0 0;0.71428571428571 0 0;0.697802197802194 0 0;0.681318681318677 0 0;0.664835164835161 0 0;0.648351648351644 0 0;0.631868131868128 0 0;0.615384615384611 0 0;0.598901098901094 0 0;0.582417582417578 0 0;0.565934065934061 0 0;0.549450549450545 0 0;0.532967032967028 0 0;0.516483516483512 0 0;0.5 0 0]);
set(ha(2),'ytick',[5 10 20 30] ,'YTickLabel',[5,10,20,30]);
set(ha(2),'FontSize',10);
set(ha(2),'XTick',[-5 -3 0], 'XTickLabel',[-5 -3 0]);
set(ha(2),'box','off');
set(ha(2),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(Ylab(2),'Position',[-6.944313695086515,10.956865192519452,1]);
set(Xlab(2),'Position',[-1.52940795000862,4.1922239620615,1]);
set(cbh,'Ticks',[-0.2:0.2:0.2],'TickLabels',[-0.2:0.2:0.2]);
line([-5 -5],get(ha(2),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([-3 -3],get(ha(2),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([0 0],get(ha(2),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)

% Create textbox
annotation('textbox',...
    [0.519311391223156  0.965565350540506 0.0259978985413909 0.0435663617188686],...
    'String',{'b'},...
    'FontWeight','bold',...
    'FontSize',11,...
    'EdgeColor','none');

annotation('textbox',...
    [0.537978457172349 0.719062848790154 0.0582083321242695 0.0304270828207954],...
    'Color',[0.15 0.15 0.15],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.573256234950128 0.719062848790155 0.107597219541255 0.0304270828207954],...
    'Color',[0.15 0.15 0.15],...
    'String','encoding',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.663214568283461 0.719062848790155 0.134055552086069 0.0304270828207954],...
    'Color',[0.15 0.15 0.15],...
    'String','maintenance',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');
%% Panel c
axes(ha(3));
contourf(timeAxis,freqAxis,P44,100,'LineColor','none')
Xlab(3) = xlabel('Time (s)');
Ylab(3) = ylabel('Frequency (Hz)');
ylim([5 30]);
title('Subject 3')
cbh = colorbar



set(ha(3),'clim',clim,'yscale','log','Colormap',...
     [0 0 0.5;0 0.0153846153846154 0.515384615384615;0 0.0307692307692308 0.530769230769231;0 0.0461538461538462 0.546153846153846;0 0.0615384615384615 0.561538461538462;0 0.0769230769230769 0.576923076923077;0 0.0923076923076923 0.592307692307692;0 0.107692307692308 0.607692307692308;0 0.123076923076923 0.623076923076923;0 0.138461538461538 0.638461538461538;0 0.153846153846154 0.653846153846154;0 0.169230769230769 0.669230769230769;0 0.184615384615385 0.684615384615385;0 0.2 0.7;0 0.215384615384615 0.715384615384615;0 0.230769230769231 0.730769230769231;0 0.246153846153846 0.746153846153846;0 0.261538461538461 0.761538461538461;0 0.276923076923077 0.776923076923077;0 0.292307692307692 0.792307692307692;0 0.307692307692308 0.807692307692308;0 0.323076923076923 0.823076923076923;0 0.338461538461538 0.838461538461538;0 0.353846153846154 0.853846153846154;0 0.369230769230769 0.869230769230769;0 0.384615384615385 0.884615384615384;0 0.4 0.9;0 0.415384615384615 0.915384615384615;0 0.430769230769231 0.930769230769231;0 0.446153846153846 0.946153846153846;0 0.461538461538462 0.961538461538462;0 0.476923076923077 0.976923076923077;0 0.492307692307692 0.992307692307692;0.0153846153846156 0.507692307692308 1;0.0461538461538464 0.523076923076923 1;0.0769230769230774 0.538461538461539 1;0.107692307692308 0.553846153846154 1;0.138461538461539 0.56923076923077 1;0.16923076923077 0.584615384615385 1;0.200000000000001 0.6 1;0.230769230769232 0.615384615384616 1;0.261538461538462 0.630769230769231 1;0.292307692307693 0.646153846153847 1;0.323076923076924 0.661538461538462 1;0.353846153846155 0.676923076923078 1;0.384615384615386 0.692307692307693 1;0.415384615384617 0.707692307692308 1;0.446153846153848 0.723076923076924 1;0.476923076923078 0.738461538461539 1;0.507692307692309 0.753846153846155 1;0.53846153846154 0.76923076923077 1;0.569230769230771 0.784615384615385 1;0.600000000000002 0.800000000000001 1;0.630769230769233 0.815384615384616 1;0.661538461538464 0.830769230769232 1;0.692307692307694 0.846153846153847 1;0.723076923076925 0.861538461538463 1;0.753846153846156 0.876923076923078 1;0.784615384615387 0.892307692307693 1;0.815384615384618 0.907692307692309 1;0.846153846153848 0.923076923076924 1;0.876923076923079 0.93846153846154 1;0.90769230769231 0.953846153846155 1;0.938461538461541 0.969230769230771 1;0.972972972972973 0.986486486486487 1;0.996138996138996 0.998069498069498 1;1 1 1;1 0.978021978021978 0.978021978021978;1 0.945054945054944 0.945054945054944;1 0.912087912087911 0.912087912087911;1 0.879120879120878 0.879120879120878;1 0.846153846153845 0.846153846153845;1 0.813186813186812 0.813186813186812;1 0.780219780219779 0.780219780219779;1 0.747252747252746 0.747252747252746;1 0.714285714285713 0.714285714285713;1 0.681318681318679 0.681318681318679;1 0.648351648351646 0.648351648351646;1 0.615384615384613 0.615384615384613;1 0.58241758241758 0.58241758241758;1 0.549450549450547 0.549450549450547;1 0.516483516483514 0.516483516483514;1 0.483516483516481 0.483516483516481;1 0.450549450549448 0.450549450549448;1 0.417582417582414 0.417582417582414;1 0.384615384615381 0.384615384615381;1 0.351648351648348 0.351648351648348;1 0.318681318681315 0.318681318681315;1 0.285714285714282 0.285714285714282;1 0.252747252747249 0.252747252747249;1 0.219780219780216 0.219780219780216;1 0.186813186813183 0.186813186813183;1 0.153846153846149 0.153846153846149;1 0.120879120879116 0.120879120879116;1 0.0879120879120832 0.0879120879120832;1 0.0549450549450501 0.0549450549450501;1 0.021978021978017 0.021978021978017;0.994505494505492 0 0;0.978021978021975 0 0;0.961538461538459 0 0;0.945054945054942 0 0;0.928571428571426 0 0;0.912087912087909 0 0;0.895604395604393 0 0;0.879120879120876 0 0;0.862637362637359 0 0;0.846153846153843 0 0;0.829670329670326 0 0;0.81318681318681 0 0;0.796703296703293 0 0;0.780219780219777 0 0;0.76373626373626 0 0;0.747252747252743 0 0;0.730769230769227 0 0;0.71428571428571 0 0;0.697802197802194 0 0;0.681318681318677 0 0;0.664835164835161 0 0;0.648351648351644 0 0;0.631868131868128 0 0;0.615384615384611 0 0;0.598901098901094 0 0;0.582417582417578 0 0;0.565934065934061 0 0;0.549450549450545 0 0;0.532967032967028 0 0;0.516483516483512 0 0;0.5 0 0]);
set(ha(3),'ytick',[5 10 20 30] ,'YTickLabel',[5,10,20,30]);
set(ha(3),'FontSize',10);
set(ha(3),'XTick',[-5 -3 0], 'XTickLabel',[-5 -3 0]);
set(ha(3),'box','off');
set(ha(3),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(Ylab(3),'Position',[-6.858752197760312,10.956865007409023,1]);
set(Xlab(3),'Position',[-1.529407950008617,4.234877095334078,1]);
set(cbh,'Ticks',[-0.2:0.2:0.2],'TickLabels',[-0.2:0.2:0.2]);
line([-5 -5],get(ha(3),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([-3 -3],get(ha(3),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([0 0],get(ha(3),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)


annotation('textbox',...
    [0.008403361344538,0.643075767207174,0.025997898541391,0.043566361718869],...
    'String',{'c'},...
    'FontWeight','bold',...
    'FontSize',11,...
    'EdgeColor','none');

annotation('textbox',...
    [0.058200679394568,0.404208682123494,0.05820833212427,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.091714568283457,0.404208682123494,0.107597219541255,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','encoding',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.179909012727901,0.404208682123494,0.134055552086069,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','maintenance',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');

%% Panel d

axes(ha(4));
contourf(timeAxis,freqAxis,P38,100,'LineColor','none')
Xlab(4) = xlabel('Time (s)');
Ylab(4) = ylabel('Frequency (Hz)');
ylim([5 30]);
title('Subject 4')
cbh = colorbar


set(ha(4),'clim',clim,'yscale','log','Colormap',...
     [0 0 0.5;0 0.0153846153846154 0.515384615384615;0 0.0307692307692308 0.530769230769231;0 0.0461538461538462 0.546153846153846;0 0.0615384615384615 0.561538461538462;0 0.0769230769230769 0.576923076923077;0 0.0923076923076923 0.592307692307692;0 0.107692307692308 0.607692307692308;0 0.123076923076923 0.623076923076923;0 0.138461538461538 0.638461538461538;0 0.153846153846154 0.653846153846154;0 0.169230769230769 0.669230769230769;0 0.184615384615385 0.684615384615385;0 0.2 0.7;0 0.215384615384615 0.715384615384615;0 0.230769230769231 0.730769230769231;0 0.246153846153846 0.746153846153846;0 0.261538461538461 0.761538461538461;0 0.276923076923077 0.776923076923077;0 0.292307692307692 0.792307692307692;0 0.307692307692308 0.807692307692308;0 0.323076923076923 0.823076923076923;0 0.338461538461538 0.838461538461538;0 0.353846153846154 0.853846153846154;0 0.369230769230769 0.869230769230769;0 0.384615384615385 0.884615384615384;0 0.4 0.9;0 0.415384615384615 0.915384615384615;0 0.430769230769231 0.930769230769231;0 0.446153846153846 0.946153846153846;0 0.461538461538462 0.961538461538462;0 0.476923076923077 0.976923076923077;0 0.492307692307692 0.992307692307692;0.0153846153846156 0.507692307692308 1;0.0461538461538464 0.523076923076923 1;0.0769230769230774 0.538461538461539 1;0.107692307692308 0.553846153846154 1;0.138461538461539 0.56923076923077 1;0.16923076923077 0.584615384615385 1;0.200000000000001 0.6 1;0.230769230769232 0.615384615384616 1;0.261538461538462 0.630769230769231 1;0.292307692307693 0.646153846153847 1;0.323076923076924 0.661538461538462 1;0.353846153846155 0.676923076923078 1;0.384615384615386 0.692307692307693 1;0.415384615384617 0.707692307692308 1;0.446153846153848 0.723076923076924 1;0.476923076923078 0.738461538461539 1;0.507692307692309 0.753846153846155 1;0.53846153846154 0.76923076923077 1;0.569230769230771 0.784615384615385 1;0.600000000000002 0.800000000000001 1;0.630769230769233 0.815384615384616 1;0.661538461538464 0.830769230769232 1;0.692307692307694 0.846153846153847 1;0.723076923076925 0.861538461538463 1;0.753846153846156 0.876923076923078 1;0.784615384615387 0.892307692307693 1;0.815384615384618 0.907692307692309 1;0.846153846153848 0.923076923076924 1;0.876923076923079 0.93846153846154 1;0.90769230769231 0.953846153846155 1;0.938461538461541 0.969230769230771 1;0.972972972972973 0.986486486486487 1;0.996138996138996 0.998069498069498 1;1 1 1;1 0.978021978021978 0.978021978021978;1 0.945054945054944 0.945054945054944;1 0.912087912087911 0.912087912087911;1 0.879120879120878 0.879120879120878;1 0.846153846153845 0.846153846153845;1 0.813186813186812 0.813186813186812;1 0.780219780219779 0.780219780219779;1 0.747252747252746 0.747252747252746;1 0.714285714285713 0.714285714285713;1 0.681318681318679 0.681318681318679;1 0.648351648351646 0.648351648351646;1 0.615384615384613 0.615384615384613;1 0.58241758241758 0.58241758241758;1 0.549450549450547 0.549450549450547;1 0.516483516483514 0.516483516483514;1 0.483516483516481 0.483516483516481;1 0.450549450549448 0.450549450549448;1 0.417582417582414 0.417582417582414;1 0.384615384615381 0.384615384615381;1 0.351648351648348 0.351648351648348;1 0.318681318681315 0.318681318681315;1 0.285714285714282 0.285714285714282;1 0.252747252747249 0.252747252747249;1 0.219780219780216 0.219780219780216;1 0.186813186813183 0.186813186813183;1 0.153846153846149 0.153846153846149;1 0.120879120879116 0.120879120879116;1 0.0879120879120832 0.0879120879120832;1 0.0549450549450501 0.0549450549450501;1 0.021978021978017 0.021978021978017;0.994505494505492 0 0;0.978021978021975 0 0;0.961538461538459 0 0;0.945054945054942 0 0;0.928571428571426 0 0;0.912087912087909 0 0;0.895604395604393 0 0;0.879120879120876 0 0;0.862637362637359 0 0;0.846153846153843 0 0;0.829670329670326 0 0;0.81318681318681 0 0;0.796703296703293 0 0;0.780219780219777 0 0;0.76373626373626 0 0;0.747252747252743 0 0;0.730769230769227 0 0;0.71428571428571 0 0;0.697802197802194 0 0;0.681318681318677 0 0;0.664835164835161 0 0;0.648351648351644 0 0;0.631868131868128 0 0;0.615384615384611 0 0;0.598901098901094 0 0;0.582417582417578 0 0;0.565934065934061 0 0;0.549450549450545 0 0;0.532967032967028 0 0;0.516483516483512 0 0;0.5 0 0]);
set(ha(4),'ytick',[5 10 20 30] ,'YTickLabel',[5,10,20,30]);
set(ha(4),'FontSize',10);
set(ha(4),'XTick',[-5 -3 0], 'XTickLabel',[-5 -3 0]);
set(ha(4),'box','off');
set(ha(4),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(Ylab(4),'Position',[-6.94431369508651,10.956865007409,1]);
set(Xlab(4),'Position',[-1.529407950008617,4.234877095334078,1]);

set(cbh,'Ticks',[-0.2:0.2:0.2],'TickLabels',[-0.2:0.2:0.2]);
line([-5 -5],get(ha(4),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([-3 -3],get(ha(4),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([0 0],get(ha(4),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)




annotation('textbox',...
    [0.519311391223156,0.643075767207174,0.025997898541391,0.043566361718869],...
    'String',{'d'},...
    'FontWeight','bold',...
    'FontSize',11,...
    'EdgeColor','none');

annotation('textbox',...
    [0.53797845717235,0.405531598790161,0.058208332124269,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.573256234950129,0.405531598790162,0.107597219541255,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','encoding',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.66497845717235,0.405531598790162,0.134055552086069,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','maintenance',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


%% Panel e

axes(ha(5));
contourf(timeAxis,freqAxis,P40,100,'LineColor','none')
Xlab(5) = xlabel('Time (s)');
Ylab(5) = ylabel('Frequency (Hz)');
ylim([5 30]);
title('Subject 9')
cbh = colorbar


set(ha(5),'clim',clim,'yscale','log','Colormap',...
     [0 0 0.5;0 0.0153846153846154 0.515384615384615;0 0.0307692307692308 0.530769230769231;0 0.0461538461538462 0.546153846153846;0 0.0615384615384615 0.561538461538462;0 0.0769230769230769 0.576923076923077;0 0.0923076923076923 0.592307692307692;0 0.107692307692308 0.607692307692308;0 0.123076923076923 0.623076923076923;0 0.138461538461538 0.638461538461538;0 0.153846153846154 0.653846153846154;0 0.169230769230769 0.669230769230769;0 0.184615384615385 0.684615384615385;0 0.2 0.7;0 0.215384615384615 0.715384615384615;0 0.230769230769231 0.730769230769231;0 0.246153846153846 0.746153846153846;0 0.261538461538461 0.761538461538461;0 0.276923076923077 0.776923076923077;0 0.292307692307692 0.792307692307692;0 0.307692307692308 0.807692307692308;0 0.323076923076923 0.823076923076923;0 0.338461538461538 0.838461538461538;0 0.353846153846154 0.853846153846154;0 0.369230769230769 0.869230769230769;0 0.384615384615385 0.884615384615384;0 0.4 0.9;0 0.415384615384615 0.915384615384615;0 0.430769230769231 0.930769230769231;0 0.446153846153846 0.946153846153846;0 0.461538461538462 0.961538461538462;0 0.476923076923077 0.976923076923077;0 0.492307692307692 0.992307692307692;0.0153846153846156 0.507692307692308 1;0.0461538461538464 0.523076923076923 1;0.0769230769230774 0.538461538461539 1;0.107692307692308 0.553846153846154 1;0.138461538461539 0.56923076923077 1;0.16923076923077 0.584615384615385 1;0.200000000000001 0.6 1;0.230769230769232 0.615384615384616 1;0.261538461538462 0.630769230769231 1;0.292307692307693 0.646153846153847 1;0.323076923076924 0.661538461538462 1;0.353846153846155 0.676923076923078 1;0.384615384615386 0.692307692307693 1;0.415384615384617 0.707692307692308 1;0.446153846153848 0.723076923076924 1;0.476923076923078 0.738461538461539 1;0.507692307692309 0.753846153846155 1;0.53846153846154 0.76923076923077 1;0.569230769230771 0.784615384615385 1;0.600000000000002 0.800000000000001 1;0.630769230769233 0.815384615384616 1;0.661538461538464 0.830769230769232 1;0.692307692307694 0.846153846153847 1;0.723076923076925 0.861538461538463 1;0.753846153846156 0.876923076923078 1;0.784615384615387 0.892307692307693 1;0.815384615384618 0.907692307692309 1;0.846153846153848 0.923076923076924 1;0.876923076923079 0.93846153846154 1;0.90769230769231 0.953846153846155 1;0.938461538461541 0.969230769230771 1;0.972972972972973 0.986486486486487 1;0.996138996138996 0.998069498069498 1;1 1 1;1 0.978021978021978 0.978021978021978;1 0.945054945054944 0.945054945054944;1 0.912087912087911 0.912087912087911;1 0.879120879120878 0.879120879120878;1 0.846153846153845 0.846153846153845;1 0.813186813186812 0.813186813186812;1 0.780219780219779 0.780219780219779;1 0.747252747252746 0.747252747252746;1 0.714285714285713 0.714285714285713;1 0.681318681318679 0.681318681318679;1 0.648351648351646 0.648351648351646;1 0.615384615384613 0.615384615384613;1 0.58241758241758 0.58241758241758;1 0.549450549450547 0.549450549450547;1 0.516483516483514 0.516483516483514;1 0.483516483516481 0.483516483516481;1 0.450549450549448 0.450549450549448;1 0.417582417582414 0.417582417582414;1 0.384615384615381 0.384615384615381;1 0.351648351648348 0.351648351648348;1 0.318681318681315 0.318681318681315;1 0.285714285714282 0.285714285714282;1 0.252747252747249 0.252747252747249;1 0.219780219780216 0.219780219780216;1 0.186813186813183 0.186813186813183;1 0.153846153846149 0.153846153846149;1 0.120879120879116 0.120879120879116;1 0.0879120879120832 0.0879120879120832;1 0.0549450549450501 0.0549450549450501;1 0.021978021978017 0.021978021978017;0.994505494505492 0 0;0.978021978021975 0 0;0.961538461538459 0 0;0.945054945054942 0 0;0.928571428571426 0 0;0.912087912087909 0 0;0.895604395604393 0 0;0.879120879120876 0 0;0.862637362637359 0 0;0.846153846153843 0 0;0.829670329670326 0 0;0.81318681318681 0 0;0.796703296703293 0 0;0.780219780219777 0 0;0.76373626373626 0 0;0.747252747252743 0 0;0.730769230769227 0 0;0.71428571428571 0 0;0.697802197802194 0 0;0.681318681318677 0 0;0.664835164835161 0 0;0.648351648351644 0 0;0.631868131868128 0 0;0.615384615384611 0 0;0.598901098901094 0 0;0.582417582417578 0 0;0.565934065934061 0 0;0.549450549450545 0 0;0.532967032967028 0 0;0.516483516483512 0 0;0.5 0 0]);
set(ha(5),'ytick',[5 10 20 30] ,'YTickLabel',[5,10,20,30]);
set(ha(5),'FontSize',10);
set(ha(5),'XTick',[-5 -3 0], 'XTickLabel',[-5 -3 0]);
set(ha(5),'box','off');
set(ha(5),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(Ylab(5),'Position',[-6.858752197760312,10.956865007409023,1]);
set(Xlab(5),'Position',[-1.529407950008617,4.234877095334078,1]);

set(cbh,'Ticks',[-0.2:0.2:0.2],'TickLabels',[-0.2:0.2:0.2]);
line([-5 -5],get(ha(5),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([-3 -3],get(ha(5),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)
line([0 0],get(ha(5),'YLim'),'Color',[0.15 0.15 0.15],'LineWidth',1)


annotation('textbox',...
    [0.008403361344538,0.330867433873847,0.025997898541391,0.043566361718869],...
    'String',{'e'},...
    'FontWeight','bold',...
    'FontSize',11,...
    'EdgeColor','none');


annotation('textbox',...
    [0.056436790505679,0.09332326545683,0.05820833212427,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.093478457172346,0.093323265456829,0.107597219541255,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','encoding',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.178145123839012,0.093323265456829,0.134055552086069,0.030427082820795],...
    'Color',[0.15 0.15 0.15],...
    'String','maintenance',...
    'FontWeight','bold',...
    'FontSize',7,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% %% Save Fig in Different Formats
% 
% set(gcf,'color','white');
% set(gcf, 'InvertHardcopy', 'off');
% set(ha(1:size(ha)),'box','off');
% set(ha(end),'XColor','none', 'YColor','none')
% print(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR Granger\TFR_Granger','-dpdf','-r2000');
% print(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR Granger\TFR_Granger','-dpng','-r2000');
% print(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR Granger\TFR_Granger','-depsc','-r2000');
% saveas(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR Granger\TFR_Granger.fig');