%% Close all figures, clear variables and command window
close all
clear
clc


%% Paths
strPaths.Main = 'F:\Vasileios\';
strPaths.Project = [strPaths.Main, 'Task Analysis\'];
strPaths.GeneralFunctions = 'F:\Vasileios\Task Analysis\Code\';
strPaths.Data = [strPaths.Main, 'Task Analysis\Data\'];
strPaths.ExtractedData = [strPaths.Main, 'Task Analysis\Extracted_Data Sternberg\'];
strPaths.Statistics = [strPaths.Main, 'Task Analysis\Code\Statistics\'];
strPaths.ChanLoc = [strPaths.Main, 'Task Analysis\Code\Channel Localization\'];
strPaths.EEGLAB_Subfunctions = [strPaths.Main,'Task Analysis\Code\Subfunctions\EEGLAB Subfunctions\'];
strPaths.Subfunctions = [strPaths.Main,'Task Analysis\Code\Subfunctions\']
% Results
strPaths.Results = [strPaths.Main,'Task Analysis\Analysis Results\'];

% FieldTrip toolbox
% strPaths.Toolboxes.FieldTrip            = 'F:\Vasileios\Toolboxes\fieldtrip-20191126\';
strPaths.Toolboxes.FieldTrip            = 'F:\Vasileios\Toolboxes\fieldtrip-20200315\';

% EEGLAB toolbox
strPaths.Toolboxes.EEGLAB               = 'F:\Vasileios\Toolboxes\eeglab14_1_1b\';

% Change main directory
cd(strPaths.Main)

% Add all subfolders to path
addpath(strPaths.Main)
addpath(strPaths.Project)
addpath(genpath(strPaths.GeneralFunctions))
addpath(strPaths.Data)
addpath(strPaths.ExtractedData)
addpath(strPaths.Statistics)
addpath(strPaths.ChanLoc)
addpath(strPaths.Subfunctions)
addpath(strPaths.EEGLAB_Subfunctions)
addpath(strPaths.Results)
addpath(strPaths.Toolboxes.FieldTrip)
% Remove EEGLAB from path

% rmpath(genpath(strPaths.Toolboxes.EEGLAB))


% Plot colors
strPlotColors = {'b','g','r','c','k','m'};
ft_defaults

%Add figure tools on toolbar
set(groot,'defaultFigureCreateFcn',@(fig,~)addToolbarExplorationButtons(fig))
set(groot,'defaultAxesCreateFcn',@(ax,~)set(ax.Toolbar,'Visible','off'))



%% Figure Data

strPaths.FigureData = [strPaths.Data,'Analysis Data\Figure Data\'];
strFilename = [strPaths.FigureData,'TFR PSD Data for Figure\TFR_PSD_var'];
load(strFilename);

%% Figure Axes

fig = figure;
set(fig,'Units', 'centimeters')
set(fig,'Position',[4.8948,2.8581,19,20]);
h=gcf;


ha = tight_subplot(3,3,[0.05 0.05],[0.05 0.03],[0.05 0.05])
set(ha(1:size(ha,1)),'Fontsize',20)

%% Panel Labels
if 1
    % Create textbox
    annotation('textbox',...
        [0.00556973684210528 0.967345000749095 0.0459539464138971 0.0383645825842396],...
        'String',{'a'},...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    annotation('textbox',...
        [0.31889210526316 0.967345000749095 0.0459539464138972 0.0383645825842396],...
        'String','b',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    % Create textbox
    annotation('textbox',...
        [0.633607017543868 0.967345000749095 0.0459539464138972 0.0383645825842396],...
        'String','c',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    
    % Create textbox
    annotation('textbox',...
        [0.00556973684210529 0.647199167415776 0.0459539464138971 0.0383645825842396],...
        'String','d',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    % Create textbox
    annotation('textbox',...
        [0.323069736842107 0.647199167415776 0.0459539464138971 0.0383645825842396],...
        'String','e',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    % Create textbox
    annotation('textbox',...
        [0.637784649122815 0.647199167415776 0.0403837711413048 0.0383645825842396],...
        'String','f',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    % Create textbox
    annotation('textbox',...
        [0.00556973684210529 0.329699167415789 0.0459539464138971 0.0383645825842396],...
        'String','g',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
    
    % Create textbox
    annotation('textbox',...
        [0.321677192982458 0.329699167415789 0.0459539464138972 0.0383645825842396],...
        'String','h',...
        'FontWeight','bold',...
        'FontSize',11,...
        'EdgeColor','none');
 
end

%% Global Data

timeAxis = TFR_PSD_var.SubjSpectra.P10.timeAxis;
freqAxis = TFR_PSD_var.SubjSpectra.P10.freqAxis;

%% Panel a
axes(ha(1));
Panel_a_Dat = TFR_PSD_var.SubjSpectra.P37.Spectra;
clim = TFR_PSD_var.SubjSpectra.P37.clim;
contourf(timeAxis,freqAxis,Panel_a_Dat,100,'LineColor','none')
strXlabel(1) = xlabel('Time (s)');
strYlabel(1) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(1),'Ticks',[0 0.5 1]);

line([-5 -5],get(ha(1),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(1),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(1),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(1),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(1),'clim',clim);
set(ha(1),'FontSize',10)
set(ha(1),'YTickLabelMode','auto')
set(ha(1),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(1),'Box','off');
set(strYlabel(1),'Position',[-7.275261127430459,23.75078479192365,1]);
set(strXlabel(1),'Position',[-2.347724931827489,3.368320404267734,1]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end

% Create textbox
annotation('textbox',...
    [0.0417758771929825 0.686886667218631 0.0501315778683414 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.0654491228070177 0.686886667218632 0.076589910413155 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.115580701754386 0.686886667218632 0.0724122789587107 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.115580701754388,0.93559500067025,0.055701753140934,0.035718749329758],...
    'Color',[1 1 1],...
    'String',{'Parietal','Left'},...
    'FontWeight','bold',...
    'EdgeColor','none');


%% Panel b
axes(ha(2));
Panel_b_Dat = TFR_PSD_var.SubjSpectra.P44.Spectra;
clim = TFR_PSD_var.SubjSpectra.P44.clim;
contourf(timeAxis,freqAxis,Panel_b_Dat,100,'LineColor','none')
strXlabel(2) = xlabel('Time (s)');
strYlabel(2) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(2),'Ticks',[-1 -0.5 0]);


line([-5 -5],get(ha(2),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(2),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(2),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(2),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(2),'clim',clim);
set(ha(2),'FontSize',10)
set(ha(2),'YTickLabelMode','auto')
set(ha(2),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(2),'Box','off');
set(strYlabel(2),'Position',[-7.27526116371155,23.7507847919236,1]);
set(strXlabel(2),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end

% Create textbox
annotation('textbox',...
    [0.356490789473685 0.686886667218632 0.0501315778683415 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.381556578947369 0.686886667218632 0.0765899104131552 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');


% Create textbox
annotation('textbox',...
    [0.433080701754387 0.686886667218632 0.0724122789587107 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.435865789473687 0.93559500067025 0.055701753140934 0.035718749329758],...
    'Color',[1 1 1],...
    'String','Hipp',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

%% Panel c

axes(ha(3));
Panel_c_Dat = TFR_PSD_var.SubjSpectra.P38.Spectra;
clim = TFR_PSD_var.SubjSpectra.P38.clim;
contourf(timeAxis,freqAxis,Panel_c_Dat,100,'LineColor','none')
strXlabel(3) = xlabel('Time (s)');
strYlabel(3) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(3),'Ticks',[0 2 4]);


line([-5 -5],get(ha(3),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(3),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(3),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(3),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(3),'clim',clim);
set(ha(3),'FontSize',10)
set(ha(3),'YTickLabelMode','auto')
set(ha(3),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(3),'Box','off');
set(strYlabel(3),'Position',[-7.27526116371155,23.7507847919236,1.00000000000001]);
set(strXlabel(3),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end


% Create textbox
annotation('textbox',...
    [0.673990789473686 0.686886667218632 0.0501315778683413 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.697664035087721 0.686886667218632 0.0765899104131551 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.750580701754389 0.686886667218633 0.0724122789587107 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.747795614035099 0.93559500067025 0.0988706140350768 0.035718749329758],...
    'Color',[1 1 1],...
    'String','EEG P3',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

%% Panel d 

axes(ha(4));
Panel_d_Dat = TFR_PSD_var.SubjSpectra.P12.Spectra;
clim = TFR_PSD_var.SubjSpectra.P12.clim;
contourf(timeAxis,freqAxis,Panel_d_Dat,100,'LineColor','none')
strXlabel(4) = xlabel('Time (s)');
strYlabel(4) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(4),'Ticks',[-1 -0.5 0]);


line([-5 -5],get(ha(4),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(4),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(4),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(4),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(4),'clim',clim);
set(ha(4),'FontSize',10)
set(ha(4),'YTickLabelMode','auto')
set(ha(4),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(4),'Box','off');
set(strYlabel(4),'Position',[-7.27526116371155,23.7507847919236,1.00000000000001]);
set(strXlabel(4),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end

% Create textbox
annotation('textbox',...
    [0.041775877192985 0.3627720838853 0.0501315778683414 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.0654491228070197 0.3627720838853 0.0765899104131552 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.11558070175439 0.3627720838853 0.0724122789587108 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.114188157894749 0.614126250670251 0.0988706140350767 0.0357187493297582],...
    'Color',[1 1 1],...
    'String','Frontal',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');


%% Panel e
axes(ha(5));
Panel_e_Dat = TFR_PSD_var.SubjSpectra.P20.Spectra;
clim = TFR_PSD_var.SubjSpectra.P20.clim;
contourf(timeAxis,freqAxis,Panel_e_Dat+1,100,'LineColor','none')
strXlabel(5) = xlabel('Time (s)');
strYlabel(5) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(5),'Ticks',[-1 -0.5 0]);


line([-5 -5],get(ha(5),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(5),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(5),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(5),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(5),'clim',clim);
set(ha(5),'FontSize',10)
set(ha(5),'YTickLabelMode','auto')
set(ha(5),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(5),'Box','off');
set(strYlabel(5),'Position',[-7.27526116371155,23.7507847919236,1.00000000000001]);
set(strXlabel(5),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end


% Create textbox
annotation('textbox',...
    [0.356490789473687 0.3627720838853 0.0501315778683415 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.381556578947371 0.3627720838853 0.0765899104131552 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.430295614035092 0.3627720838853 0.0724122789587109 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.430295614035102 0.614126250670251 0.0988706140350772 0.0357187493297582],...
    'Color',[1 1 1],...
    'String',{'Parietal','Left'},...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

%% Panel f
axes(ha(6));
Panel_f_Dat = TFR_PSD_var.SubjSpectra.P26.Spectra;
clim = TFR_PSD_var.SubjSpectra.P26.clim;
contourf(timeAxis,freqAxis,Panel_f_Dat,100,'LineColor','none')
strXlabel(6) = xlabel('Time (s)');
strYlabel(6) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(6),'Ticks',[-1 -0.5 0]);


line([-5 -5],get(ha(6),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(6),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(6),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(6),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(6),'clim',clim);
set(ha(6),'FontSize',10)
set(ha(6),'YTickLabelMode','auto')
set(ha(6),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(6),'Box','off');
set(strYlabel(6),'Position',[-7.27526116371155,23.7507847919236,1.00000000000001]);
set(strXlabel(6),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end

% Create textbox
annotation('textbox',...
    [0.745010526315811 0.614126250670251 0.0988706140350772 0.0357187493297582],...
    'Color',[1 1 1],...
    'String',{'Temporal','Right'},...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.673990789473688 0.362772083885301 0.0501315778683414 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.699056578947371 0.362772083885301 0.0765899104131551 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.749188157894741 0.362772083885301 0.0724122789587109 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

%% Panel g
axes(ha(7));
Panel_g_Dat = TFR_PSD_var.SubjSpectra.P40.Spectra;
clim = TFR_PSD_var.SubjSpectra.P40.clim;
contourf(timeAxis,freqAxis,-Panel_g_Dat-1,100,'LineColor','none')
strXlabel(7) = xlabel('Time (s)');
strYlabel(7) = ylabel('Frequency (Hz)');
colormap(flipud(jet))
colorbar(ha(7),'Ticks',[-1 -0.5 0]);


line([-5 -5],get(ha(7),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(7),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(7),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(7),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(7),'clim',[-1 1]);
set(ha(7),'FontSize',10)
set(ha(7),'YTickLabelMode','auto')
set(ha(7),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(7),'Box','off');
set(strYlabel(7),'Position',[-7.27526116371155,23.7507847919236,1.00000000000001]);
set(strXlabel(7),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end

% Create textbox
annotation('textbox',...
    [0.0403833333333372 0.0399804172186343 0.0501315778683416 0.0317499994480361],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.065449122807021 0.0399804172186341 0.0765899104131553 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.114188157894742 0.0399804172186341 0.072412278958711 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.1267210526316 0.291334584003584 0.0988706140350773 0.0357187493297582],...
    'Color',[1 1 1],...
    'String','Hipp',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

%% Panel h 
axes(ha(8));
Panel_h_Dat = TFR_PSD_var.SubjSpectra.P10.Spectra;
clim = TFR_PSD_var.SubjSpectra.P10.clim;
contourf(timeAxis,freqAxis,Panel_h_Dat,100,'LineColor','none')
strXlabel(8) = xlabel('Time (s)');
strYlabel(8) = ylabel('Frequency (Hz)');
colormap jet
colorbar(ha(8),'Ticks',[-1 -0.5 0]);


line([-5 -5],get(ha(8),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([-3 -3],get(ha(8),'YLim'),'Color',[1 1 1],'LineWidth',1)
line([0 0],get(ha(8),'YLim'),'Color',[1 1 1],'LineWidth',1)

set(ha(8),'Color',[0.01 0.01 0.56],'XTick',...
    [-5 -3 0],'XTickLabel',['-5';'-3';'0 '],'YMinorTick','on','YScale','log',...
    'YTick',[4 10 20 40 100]);

%Axes properties
set(ha(8),'clim',clim);
set(ha(8),'FontSize',10)
set(ha(8),'YTickLabelMode','auto')
set(ha(8),'TickDir','out','XMinorTick','off','YMinorTick','off','TickLength',[0.02 0.025]);
set(ha(8),'Box','off');
set(strYlabel(8),'Position',[-7.27526116371155,23.7507847919236,1.00000000000001]);
set(strXlabel(8),'Position',[-1.99999618530273,3.36832040426773,1.00000000000001]);
xTick = get(gca,'xtick');
yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTickLabel = {'-5','-3','0'};
yTickLabel = {'4','10','20','40','100'};
for k = 1:length(xTick)
    text(xTick(k),4,xTickLabel{k},'HorizontalAlignment','center','VerticalAlignment','top')
end


% Create textbox
annotation('textbox',...
    [0.357883333333338 0.0386575005519677 0.0501315778683417 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','fix.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.381556578947372 0.0386575005519674 0.0765899104131553 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','encod.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.430295614035093 0.0386575005519675 0.0724122789587109 0.0317499994480362],...
    'Color',[1 1 1],...
    'String','maint.',...
    'FontWeight','bold',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation('textbox',...
    [0.440043421052656 0.291334584003584 0.0988706140350777 0.0357187493297582],...
    'Color',[1 1 1],...
    'String','Hipp',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% %% Save Fig in Different Formats
% 
% set(gcf,'color','white');
% set(gcf, 'InvertHardcopy', 'off');
% set(ha(1:size(ha)),'box','off');
% set(ha(end),'XColor','none', 'YColor','none')
% print(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR PSD\TFR_PSD','-dpdf','-r2000');
% print(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR PSD\TFR_PSD','-dpng','-r2000');
% print(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR PSD\TFR_PSD','-depsc','-r2000');
% saveas(fig,'F:\Vasileios\Task Analysis\Analysis Results\Results_for_Publication\Publication Ready Figure\Portrait Figs\TFR PSD\TFR_PSD.fig');
